#sh
# The next line is executed by /bin/sh, but not Tcl \
exec tclsh $0 $1

# get input image file name as first argument
if {($argc != 0) && ($argc != 1)} { 
  puts stderr "usage: videothumb_dir [prefix]"
  exit 
}

set VTD(prefix) ""
if {$argc == 1} { 
 set VTD(prefix) [lindex $argv 0]
 puts "prefix: $VTD(prefix)"
}

set filelist [glob -nocomplain "$VTD(prefix)*.mpg"]
foreach file $filelist {
  set name [file rootname $file]
  catch { exec videothumb $file "thumb_$name.jpg" } mes
  puts "file $file processed"
}

set filelist [glob -nocomplain "$VTD(prefix)*.mpeg"]
foreach file $filelist {
  set name [file rootname $file]
  catch { exec videothumb $file "thumb_$name.jpg" } mes
  puts "file $file processed"
}

set filelist [glob -nocomplain "$VTD(prefix)*.avi"]
foreach file $filelist {
  set name [file rootname $file]
  catch { exec videothumb $file "thumb_$name.jpg" } mes
  puts "file $file processed"
}

set filelist [glob -nocomplain "$VTD(prefix)*.wmv"]
foreach file $filelist {
  set name [file rootname $file]
  catch { exec videothumb $file "thumb_$name.jpg" } mes
  puts "file $file processed"
}
